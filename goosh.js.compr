var goosh=new Object();goosh.lib=new Object();goosh.lib.namespace=function(c){var d=c.split(".");var a=window;for(var b=0;b<d.length;b++){if(typeof a[d[b]]=="undefined"){a[d[b]]=new Object()}a=a[d[b]]}};goosh.lib.in_array=function(a,c){var b;for(b=0;b<a.length;b++){if(a[b]==c){return true}}return false};goosh.lib.chop=function(a){if(a){while(a.charAt(0)==" "){a=a.substr(1)}}return a};goosh.lib.namespace("goosh.lib");goosh.lib.get=function(b){b=b.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a="[\\?&]"+b+"=([^&#]*)";var d=new RegExp(a);var c=d.exec(window.location.href);if(c==null){return""}else{return decodeURIComponent(c[1]).replace(/\+/g," ")}};goosh.lib.namespace("goosh.lib.cookie");goosh.lib.cookie.list=new Object();goosh.lib.cookie.getfromstr=function(f,g){var a=f.split(";");for(var c=0;c<a.length;c++){var e=a[c].split("=");var b=goosh.lib.chop(e[0]);var d=goosh.lib.chop(e[1]);if(g&&goosh.lib.cookie.list[b]!=d){goosh.lib.cookie.set(b,d,365)}goosh.lib.cookie.list[b]=d}};goosh.lib.cookie.get=function(a){return goosh.lib.cookie.list[a]};goosh.lib.cookie.set=function(b,d,f){var c=new Date();var e=c.getTime()+(f*24*60*60*1000);c.setTime(e);document.cookie=b+"="+d+"; expires="+c.toGMTString();if(goosh.config.user!="guest"&&b!="loggedin"){var a="";if(f<0){a="&del=1"}goosh.ajax.query("http://goosh.appspot.com/cookie?key="+encodeURIComponent(b)+"&val="+encodeURIComponent(d)+"&callback=goosh.lib.cookie.fetch"+a,true)}goosh.lib.cookie.list[b]=d;return d};goosh.lib.cookie.del=function(a){goosh.lib.cookie.set(a,"",-100);goosh.lib.cookie.list[a]=null};goosh.lib.cookie.getall=function(){return goosh.lib.cookie.list};goosh.lib.namespace("goosh.lang");goosh.lang.list={arabic:"ar",bulgarian:"bg",catalan:"ca",chinese:"zh",chinese_simplified:"zh-cn",chinese_traditional:"zh-tw",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",filipino:"tl",finnish:"fi",french:"fr",german:"de",greek:"el",hebrew:"iw",hindi:"hi",hungarian:"hu",indonesian:"id",italian:"it",japanese:"ja",korean:"ko",latvian:"lv",lithuanian:"lt",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swedish:"sv",thai:"th",turkish:"tr",ukrainian:"uk",vietnamese:"vi"};goosh.lang.reverse=new Object();for(key in goosh.lang.list){goosh.lang.reverse[goosh.lang.list[key]]=key}goosh.lib.namespace("goosh.gui");goosh.gui.inputel=false;goosh.gui.outputel=false;goosh.gui.promptel=false;goosh.gui.inputfield=false;goosh.gui.bodyel=false;goosh.gui.headel=false;goosh.gui.el=function(a){return document.getElementById(a)};goosh.gui.init=function(){goosh.gui.inputel=document.getElementById("input");goosh.gui.outputel=document.getElementById("output");goosh.gui.promptel=document.getElementById("prompt");goosh.gui.inputfield=document.getElementById("inputfield");goosh.gui.bodyel=document.getElementById("body");goosh.gui.headel=document.getElementById("head");if(goosh.gui.inputfield.createTextRange){goosh.gui.inputfield.onkeyup=new Function("return goosh.keyboard.mcursor(event);");goosh.gui.bodyel.onfocus=new Function("return goosh.gui.focusinput(event);");goosh.gui.bodyel.onclick=new Function("return goosh.gui.focusinput(event);");goosh.gui.bodyel.onkeydown=new Function("return goosh.keyboard.keyDownHandler(event);")}else{goosh.gui.inputfield.onkeyup=goosh.keyboard.mcursor;goosh.gui.bodyel.onfocus=goosh.gui.focusinput;goosh.gui.bodyel.onclick=goosh.gui.focusinput;goosh.gui.bodyel.onkeydown=goosh.keyboard.keyDownHandler}};goosh.gui.error=function(a){goosh.ajax.stopall();goosh.gui.out("Error: "+a+"<br/> <br/>");goosh.gui.showinput();goosh.gui.focusinput();goosh.gui.scroll()};goosh.gui.outln=function(a){goosh.gui.out(a+"<br/>")};goosh.gui.out=function(a){var b=document.createElement("div");b.innerHTML=a;goosh.gui.outputel.appendChild(b);return b};goosh.gui.css=function(a){var b=document.createElement("link");b.href=a;b.rel="stylesheet";b.type="text/css";goosh.gui.bodyel.appendChild(b);return b};goosh.gui.less=function(a){return"<span class='less'>"+a+"</span>"};goosh.gui.info=function(a){return"<span class='info'>"+a+"</span>"};goosh.gui.clear=function(){goosh.gui.outputel.innerHTML=""};goosh.gui.showinput=function(){goosh.gui.inputel.style.display="block"};goosh.gui.hideinput=function(){goosh.gui.inputel.style.display="none"};goosh.gui.focusinput=function(){var a="";if(document.selection){a=document.selection.createRange().text}else{if(window.getSelection){a=window.getSelection().toString()}}if(a.length==0){document.f.q.value=document.f.q.value;if(goosh.gui.inputel.style.display!="none"){document.f.q.focus()}}};goosh.gui.updateprompt=function(){goosh.gui.prompt=goosh.config.user+"@"+goosh.config.host+":/"+goosh.config.mode+goosh.config.pend;goosh.gui.promptel.innerHTML=goosh.gui.prompt};goosh.gui.scroll=function(){window.scrollBy(0,122500)};goosh.gui.setstyle=function(b,f,d){try{var a=goosh.gui.el(b);a.style[f]=d;return true}catch(c){return false}};goosh.gui.setstyleclass=function(c,b){var d=document.createElement("div");var a="<br style='line-height:0px;'/><style>"+c+" {"+b+"}</style>";d.innerHTML=a;goosh.gui.bodyel.appendChild(d)};goosh.lib.namespace("goosh.set");goosh.set.base=function(name,def,txt,min,max){this.name=name;this.txt=txt;this.def=def;(max)?this.max=max:this.max=2000;(min)?this.min=min:this.min=0;if(min&&max){this.txt+=" ("+min+".."+max+")"}this.get=function(){return eval(""+this.name+";")};this.set=function(val){eval(""+this.name+" = '"+val+"';");return true}};goosh.set.list=new Object();goosh.set.list.lang=new goosh.set.base("goosh.config.lang","en","google default language");goosh.set.list.lang.set=function(a){if(goosh.lang.reverse[a]){goosh.config.lang=a}else{if(goosh.lang.list[a]){goosh.config.lang=goosh.lang.list[a]}else{return false}}return true};goosh.set.list.results=new goosh.set.base("goosh.config.numres","4","number of results for google-searches",1,100);goosh.set.list.timeout=new goosh.set.base("goosh.config.timeout","4","timeout for ajax requests in seconds",1,100);goosh.set.list["style.bg"]=new goosh.set.base("goosh.config.bgcolor","#FFFFFF","goosh background color");goosh.set.list["style.bg"].set=function(a){if(goosh.gui.setstyle("body","backgroundColor",a)&&goosh.gui.setstyle("inputfield","backgroundColor",a)){goosh.config.bgcolor=a;return true}else{return false}};goosh.set.list["style.fg"]=new goosh.set.base("goosh.config.fgcolor","#000000","goosh font color");goosh.set.list["style.fg"].set=function(a){if(goosh.gui.setstyle("body","color",a)&&goosh.gui.setstyle("inputfield","color",a)){goosh.config.fgcolor=a;return true}else{return false}};goosh.set.list["style.hl"]=new goosh.set.base("goosh.config.hlcolor","#009900","goosh highlight color");goosh.set.list["style.hl"].set=function(a){goosh.gui.setstyleclass(".info","color: "+a);goosh.gui.setstyleclass("a:visited.info","color: "+a);goosh.config.hlcolor=a;return true};goosh.set.list["style.sh"]=new goosh.set.base("goosh.config.shcolor","#666666","goosh 'shaded' color");goosh.set.list["style.sh"].set=function(a){goosh.gui.setstyleclass(".less","color: "+a);goosh.config.shcolor=a;return true};goosh.set.list["style.link"]=new goosh.set.base("goosh.config.linkcolor","#0000CC","goosh link color");goosh.set.list["style.link"].set=function(a){goosh.gui.setstyleclass("a","color: "+a);goosh.config.linkcolor=a;return true};goosh.set.list["style.vlink"]=new goosh.set.base("goosh.config.vlinkcolor","#551a8b","goosh visited link color");goosh.set.list["style.vlink"].set=function(a){goosh.gui.setstyleclass("a:visited","color: "+a);goosh.config.vlinkcolor=a;return true};goosh.set.list.theme=new goosh.set.base("goosh.config.theme","","ace theme");goosh.set.list.theme.set=function(a){goosh.gui.css("/css/"+a+".css");goosh.config.theme=a;return true};goosh.set.list["place.width"]=new goosh.set.base("goosh.config.mapwidth","300","width of map image",20,600);goosh.set.list["place.height"]=new goosh.set.base("goosh.config.mapheight","150","height of map image",20,500);goosh.set.list["amazon.reflink"]=new goosh.set.base("goosh.config.reflink","on","Add referer links to amazon product links");goosh.set.init=function(b,a){if(goosh.config.user!="guest"){if(!b){goosh.ajax.query("http://goosh.appspot.com/cookie?callback=goosh.set.init");return}else{if(goosh.ajax.iscontext(b)){goosh.gui.outln("Loading remote settings...");goosh.lib.cookie.getfromstr(document.cookie);goosh.lib.cookie.getfromstr(a,true)}}}else{goosh.gui.outln("Loading local settings...");goosh.lib.cookie.getfromstr(document.cookie)}var d=goosh.lib.cookie.getall();for(key in goosh.set.list){var e=false;if(d[key]){e=d[key]}if(e&&goosh.set.list[key].set(e)){goosh.gui.outln("&nbsp;"+key+" => &quot;"+e+"&quot;.")}else{goosh.set.list[key].set(goosh.set.list[key].def)}}goosh.gui.outln("");goosh.getquery()};goosh.lib.namespace("goosh.ajax");goosh.ajax.contexts=new Array();goosh.ajax.lastcontext=false;goosh.ajax.stopall=function(){for(key in goosh.ajax.contexts){goosh.ajax.iscontext(key)}};goosh.ajax.deletecontext=function(a){goosh.gui.outln("Error: Operation timed out. "+a);if(!document.all){goosh.gui.outln(goosh.gui.less('If you use the noscript firefox-extension, add "ajax.googleapis.com" to the whitelist.'))}goosh.gui.outln("");goosh.ajax.contexts[a]=false;var b=document.getElementById(a);if(b){document.body.removeChild(b)}goosh.gui.showinput();goosh.gui.focusinput();goosh.gui.scroll();if(!document.all){stop()}};goosh.ajax.iscontext=function(a){if(goosh.ajax.contexts[a]){clearTimeout(goosh.ajax.contexts[a]);goosh.ajax.contexts[a]=false;var b=document.getElementById(a);if(b){document.body.removeChild(b)}return true}else{return false}};goosh.ajax.getcontext=function(a){var c=new Date();var b=c.getTime();if(a){b=a}goosh.ajax.contexts[b]=setTimeout("goosh.ajax.deletecontext('"+b+"');",1000*goosh.config.timeout);return b};goosh.ajax.query=function(c,a){var d="none";if(!a){d=goosh.ajax.getcontext();goosh.ajax.lastcontext=d;goosh.gui.hideinput()}var b=document.createElement("script");document.body.appendChild(b);b.src=c+"&context="+d+"&";b.id=d};goosh.lib.namespace("goosh.config");goosh.config.apikey="ABQIAAAA0cXSEVCNSwf_x74KTtPJMRQP4Q7D8MPck7bhT7upyfJTzVDU2BRxkUdd2AvzlDDF7DNUJI_Y4eB6Ug";goosh.config.user="guest";goosh.config.host="goosh.org";goosh.config.mode="web";goosh.config.pend=">&nbsp;";goosh.config.numres=4;goosh.config.timeout=4;goosh.config.start=0;goosh.config.moreobj;goosh.config.lang="en";goosh.config.urls=new Array();goosh.config.cmdlines=new Array();goosh.config.cmdqueue=new Array();goosh.config.reflink="on";goosh.lib.namespace("goosh.keyboard");goosh.keyboard.suggestions=new Array();goosh.keyboard.suggpos=1;goosh.keyboard.suggword="";goosh.keyboard.hist=new Array();goosh.keyboard.histpos=0;goosh.keyboard.histtemp=0;goosh.keyboard.suggest=function(b){if(goosh.keyboard.suggpos>goosh.keyboard.suggestions[b].length){goosh.keyboard.suggpos=1}if(goosh.keyboard.suggestions[b][goosh.keyboard.suggpos]){goosh.gui.inputfield.value=goosh.keyboard.suggestions[b][goosh.keyboard.suggpos]}var c=goosh.gui.inputfield;if(c.createTextRange){var a=c.createTextRange();a.moveStart("character",b.length);a.select()}else{if(c.setSelectionRange){c.setSelectionRange(b.length,c.value.length)}}};goosh.keyboard.dummyac=function(){this.Suggest_apply=function(c,d,a,b){goosh.keyboard.suggestions[d]=a;goosh.keyboard.suggest(d);return true}};window.googlesug=new Array();window.googlesug.ac=new goosh.keyboard.dummyac();goosh.keyboard.keyDownHandler=function(b){if(!b&&window.event){b=window.event}if(b){_lastKeyCode=b.keyCode}if(b&&b.keyCode==9){b.cancelBubble=true;b.returnValue=false;var c=goosh.keyboard.suggword;if(c!=""){if(!goosh.keyboard.suggestions[c]){goosh.keyboard.suggpos=1;var a=document.createElement("script");document.body.appendChild(a);a.src="http://www.google.com/complete/search?hl="+goosh.config.lang+"&js=true&qu="+encodeURIComponent(c)}else{goosh.keyboard.suggpos+=2;goosh.keyboard.suggest(c)}}return false}};goosh.keyboard.mcursor=function(b){var a=b.keyCode;if(goosh.keyboard.hist.length>0){if(a==38||a==40){if(goosh.keyboard.hist[goosh.keyboard.histpos]){goosh.keyboard.hist[goosh.keyboard.histpos]=goosh.gui.inputfield.value}else{goosh.keyboard.histtemp=goosh.gui.inputfield.value}}if(a==38){goosh.keyboard.histpos--;if(goosh.keyboard.histpos<0){goosh.keyboard.histpos=0}}else{if(a==40){goosh.keyboard.histpos++;if(goosh.keyboard.histpos>goosh.keyboard.hist.length){goosh.keyboard.histpos=goosh.keyboard.hist.length}}}if(a==38||a==40){if(goosh.keyboard.hist[goosh.keyboard.histpos]){goosh.gui.inputfield.value=goosh.keyboard.hist[goosh.keyboard.histpos]}else{goosh.gui.inputfield.value=goosh.keyboard.histtemp}}}if(a!=9&&a!=13){goosh.keyboard.suggword=goosh.gui.inputfield.value}if(a==13){goosh.command()}};goosh.lib.namespace("goosh.modules");goosh.lib.namespace("goosh.module");goosh.lib.namespace("goosh.modobj");goosh.modules.list=new Array();goosh.module.base=function(){this.mode=false;this.parameters="";this.help="no helptext yet.";this.helptext="";this.hasmore=false;this.results=new Array()};goosh.modules.register=function(name,base){if(!base){base="base"}eval("goosh.module."+name+".prototype = new goosh.module."+base+";goosh.modobj."+name+" = new goosh.module."+name+';goosh.modules.list["'+name+'"] = goosh.modobj.'+name+";")};goosh.module.web=function(){this.name="web";this.aliases=new Array("web","search","s","w");this.mode=true;this.start=0;this.args="";this.help="google web search";this.parameters="[keywords]";this.helptext="<span class='info'>examples:</span><br/><i>web foo bar</i>  - searches the web for &quot;foo bar&quot;<br/>";this.query=function(a,c){var b={};b[google.search.Search.RESTRICT_EXTENDED_ARGS]={lr:"lang_"+goosh.config.lang};cs=new google.search.CustomSearchControl("004431332481073456201:1y01bmxbens",b);cs.setResultSetSize(goosh.config.results);google.search.Csedr.addOverride("mysite_");cs.setSearchStartingCallback(this,function(h,g,f){g.setNoHtmlGeneration();goosh.gui.hideinput();searching=true});cs.setSearchCompleteCallback(this,function(h,g,f){searching=false;this.hasmore=true;goosh.gui.showinput();goosh.gui.focusinput();goosh.gui.scroll()});var d=new google.search.DrawOptions();d.enableSearchResultsOnly();var e=goosh.gui.out();cs.draw(e,d);window.i=((goosh.config.numres-1)*this.start);cs.execute(c,this.start+1)};this.renderResult=function(d,h,g,b,e){var f="";var j=this.start;f+="<table border='0'>";for(i=this.start;i<(this.start+parseInt(goosh.config.numres));i++){if(this.results[i]){var a=this.results[i];j++;goosh.config.urls[j]=a.unescapedUrl;a.unescapedUrl=a.unescapedUrl.replace(/"/g,"&quot;");var c=a.unescapedUrl;if(goosh.config.reflink=="on"){if(c.match(/\/\/(www.)?amazon.com\//)){if(c.indexOf("?")>-1){c+="&"}else{c+="?"}c+="tag=gc0a18-20"}if(c.match(/\/\/(www.)?amazon.(de|at|es|co.uk)\//)){if(c.indexOf("?")>-1){c+="&"}else{c+="?"}c+="tag=gc06-21"}goosh.config.urls[j]=c}f+="<tr>";f+="<td valign='top' class='less'>&nbsp;&nbsp;"+j+")&nbsp;</td>";f+="<td>";f+='<a href="'+c+'" target="_blank">'+a.title+"</a>";f+="<br/>";f+=a.content;f+="<br/>";f+='<a href="'+c+'" target="_blank" class="info" style="text-decoration:none;">'+a.unescapedUrl+"</a>";f+="<br/>";f+="&nbsp;</td></tr>"}}f+="</table>";goosh.gui.out(f)};this.call=function(a){if(a.length>0){this.start=0;this.qstart=0;this.results=new Array();this.args=a.join(" ");if(a.length>1&&this.name=="site"){this.args="site:"+this.args;this.cmd="web"}else{if(this.name=="wiki"){this.args="site:"+goosh.config.lang+".wikipedia.org "+this.args;this.cmd="web"}else{if(this.name=="amazon"){var b="amazon.com";if(goosh.config.lang=="de"){b="amazon.de"}this.args="site:"+b+" "+this.args;this.cmd="web"}else{this.cmd=this.name}}}this.query(this.cmd,this.args)}};this.more=function(){if(this.args){this.start++;this.qstart=this.results.length;if(this.results.length<this.start+parseInt(goosh.config.numres)){this.query(this.cmd,this.args)}else{this.renderResult()}}};this.render=function(e,d,b,c,a){if(goosh.ajax.iscontext(e)){if(d&&d.results){for(i=0;i<d.results.length;i++){var f=d.results[i];if(this.name=="blogs"){d.results[i].unescapedUrl=f.postUrl}else{if(this.name=="images"){d.results[i].thumb="<img src='"+f.tbUrl+"'  width='"+f.tbWidth+"' height='"+f.tbHeight+"'/>"}else{if(this.name=="video"){d.results[i].thumb="<img src='"+f.tbUrl+"' width='130' height='97' />";d.results[i].unescapedUrl=f.playUrl}}}this.results.push(d.results[i])}this.hasmore=true;if(d.results.length<8){this.hasmore=false;moreobj=false}}else{this.hasmore=false;moreobj=false}if(this.hasmore&&this.results.length<this.start+parseInt(goosh.config.numres)){this.qstart=this.results.length;this.query(this.cmd,this.args);return}if(d&&d.cursor&&d.cursor.moreResultsUrl){this.moreresurl=d.cursor.moreResultsUrl}if(!this.hasmore&&this.moreresurl){f=new Object();f.title="More results at google";f.unescapedUrl=unescape(this.moreresurl);f.content="";this.results.push(f)}this.renderResult(e,d,b,c,a);goosh.gui.showinput();goosh.gui.focusinput();goosh.gui.scroll()}}};goosh.modules.register("web");goosh.module.addengine=function(){this.name="addengine";this.aliases=new Array("addengine");this.help="add goosh to firefox search box";this.call=function(a){engineURL="http://goosh.org/goosh.xml";if(!document.all&&window.external&&("AddSearchProvider" in window.external)){window.external.AddSearchProvider(engineURL)}else{goosh.gui.error("addengine will only work in Firefox-Browsers.")}}};goosh.modules.register("addengine");goosh.module.amazon=function(){this.name="amazon";this.aliases=new Array("amazon","am");this.mode=true;this.help="amazon search";this.helptext="<span class='info'>examples:</span><br/><i>amazon foo bar</i>  - searches &quot;foo bar&quot; on amazon<br/>"};goosh.modules.register("amazon","web");goosh.module.blogs=function(){this.name="blogs";this.aliases=new Array("blogs","blog","b");this.mode=true;this.parameters="[keywords]";this.help="google blog search";this.helptext="<span class='info'>examples:</span><br/><i>blog foo bar</i>  - searches for &quot;foo bar&quot; blogs<br/>"};goosh.modules.register("blogs","web");goosh.module.calculate=function(){this.name="calculate";this.aliases=new Array("calculate","calc");this.help="evaluate a mathematical expression";this.parameters="[mathematical expression]";this.call=function(args){var out="";var exp=args.join(" ");var expin=exp;if(exp.match(/^[0-9\+\-\/\*\. \^\(\)]+$/)){exp=exp.replace(/([0-9]+)\^([0-9]+)/g,"Math.pow($1,$2)");goosh.gui.outln(expin+" = "+eval(exp))}else{goosh.gui.error("could not calculate that.");return false}}};goosh.modules.register("calculate");goosh.module.cd=function(){this.name="cd";this.aliases=new Array("cd");this.parameters="&lt;command>";this.help="change mode";this.helptext="This exists just for convenience. Use &lt;command> without parameters instead.<br/>";this.call=function(a){if(!a[0]){a[0]=goosh.config.mode}if(a[0]&&a[0]==".."){a[0]="web"}if(a[0]&&goosh.modules.list[a[0]]&&goosh.modules.list[a[0]].mode){var b=goosh.modules.list[a[0]];goosh.config.mode=b.name;goosh.gui.updateprompt()}else{goosh.gui.error("command not found or command is not a mode.")}}};goosh.modules.register("cd");goosh.module.clear=function(){this.name="clear";this.aliases=new Array("clear","c");this.help="clear the screen";this.call=function(a){goosh.gui.clear()}};goosh.modules.register("clear");goosh.module.feeds=function(){this.name="feeds";this.aliases=new Array("feeds","feed","f");this.mode=true;this.start=0;this.args="";this.parameters="[keywords]";this.help="google feed search";this.helptext="<span class='info'>examples:</span><br/><i>feed foo bar</i>  - searches for &quot;foo bar&quot; feeds<br/><i>read 2</i>  - reads second result<br/>";this.query=function(a,b){goosh.ajax.query("//ajax.googleapis.com/ajax/services/feed/find?v=1.0&hl="+goosh.config.lang+"&callback=goosh.modobj."+this.name+".render&q="+encodeURIComponent(b)+"&num=100&key"+goosh.config.apikey+"&")};this.call=function(a){if(a.length>0){this.start=0}this.results=new Array();this.args=a.join(" ");this.query(this.name,a.join(" "))};this.render=function(e,d,b,c,a){if(goosh.ajax.iscontext(e)){if(d&&d.entries&&d.entries.length>0){d.results=new Array();for(i=0;i<d.entries.length;i++){if(d.entries[i]){d.results[i]=d.entries[i]}}for(i=0;i<d.results.length;i++){if(d.results[i]){var f=d.results[i];d.results[i].unescapedUrl=f.url;d.results[i].content=f.contentSnippet}}this.results=d.results;this.hasmore=true;this.renderResult(e,d,b,c,a)}else{goosh.gui.error("No feeds found for &quot;"+this.args+"&quot;")}goosh.gui.showinput();goosh.gui.focusinput();goosh.gui.scroll()}};this.more=function(){if(this.args){this.start+=parseInt(goosh.config.numres);if(this.results.length<=this.start+parseInt(goosh.config.numres)){this.hasmore=false;moreobj=false}this.renderResult()}}};goosh.modules.register("feeds","web");goosh.module.go=function(){this.name="go";this.aliases=new Array("go","g");this.parameters="&lt;url>";this.help="open url";this.call=function(b){if(b[0]){var a=b[0];if(a.indexOf("http://")==-1&&a.indexOf("https://")){a="http://"+a}window.location.href=a}}};goosh.modules.register("go");goosh.module.help=function(){this.name="help";this.aliases=new Array("help","man","h","?");this.help="displays help text";this.helptext="";this.parameters="[command]";this.call=function(b){if(b[0]=="goosh"){b[0]=false}var a="<span class='info'>help";if(b[0]){a+=": "+b[0]}a+="</span><br/> <br/>";if(b[0]&&!goosh.modules.list[b[0]]){goosh.gui.error("command &quot;"+b[0]+"&quot; not found.");return false}a+="<table border='0' class='help'>";a+="<tr><td class='less'>command</td><td class='less'>aliases</td><td class='less'>parameters</td><td class='less'>function</td></tr>";var c;for(key in goosh.modules.list){if(!b[0]||key==b[0]){c=goosh.modules.list[key];a+="<tr><td";if(c.mode){a+=" class='info'"}a+=">";a+=""+c.name+"</td><td>";if(c.aliases.length>1){a+="(";for(i=0;i<c.aliases.length;i++){if(c.aliases[i]!=c.name){a+=c.aliases[i];a+=","}}a=a.substr(0,a.length-1);a+=")"}a+="</td><td>";if(c.parameters){a+=c.parameters}a+="</td><td>";a+=""+c.help+"\n";a+="</td></tr>"}}a+="</table>";if(b[0]){a+=" <br/>";a+=c.helptext;a+=" <br/>"}else{a+=" <br/>";a+="- Enter green commands without parameters to change default mode.<br/>";a+="- Anything that's not a command will search in current default mode.<br/>";a+="- Aliases will expand to commands. Numbers will expand to corresponding search results.<br/>";a+="- Use cursor up and down for command history.<br/>";a+="- Enter keyword and hit the tab-key for tab-completion.<br/>";a+="- Commands marked with * are experimental, use them with care and please report any bugs.<br/>";a+="<br/>"}goosh.gui.outln(a)}};goosh.modules.register("help");goosh.module.site=function(){this.name="site";this.aliases=new Array("site","in");this.parameters="&lt;url> &lt;keywords>";this.help="search in a specific website";this.mode=false};goosh.modules.register("site","web");goosh.module.load=function(){this.name="load";this.aliases=new Array("load");this.help="load an extension";this.parameters="&lt;extension_url>";this.call=function(c){if(c[0]){var b=c[0];if(b.indexOf("http://")==-1&&b.indexOf("https://")){b="http://goosh.org/ext/"+b+".js"}var a=document.createElement("script");document.body.appendChild(a);a.src=b}}};goosh.modules.register("load");goosh.module.ls=function(){this.name="ls";this.aliases=new Array("ls");this.help="lists commands";this.helptext="this exists just for convenience. Use <span class='info'>help</span> for help.<br/>";this.parameters="[command]";this.call=function(b){var a="";if(b[0]&&!goosh.modules.list[b[0]]){goosh.gui.error("command &quot;"+b[0]+"&quot; not found.");return false}a+="<table border='0' class='help'><tr>";var d;var c=0;for(key in goosh.modules.list){if(b.length==0||key==b[0]){d=goosh.modules.list[key];a+="<td";if(d.mode){a+=" class='info'"}a+=">"+d.name+"</td><td>";if(c==5){c=0;a+="</tr><tr>"}c++}}a+="</tr></table>";goosh.gui.outln(a)}};goosh.modules.register("ls");goosh.module.lucky=function(){this.name="lucky";this.aliases=new Array("lucky","l");this.mode=false;this.parameters="[keywords]";this.help="go directly to first result";this.helptext="<span class='info'>examples:</span><br/><i>lucky foo bar</i>  - goes to first &quot;foo bar&quot; result<br/>";this.call=function(a){this.qstart=0;if(a.length>0){this.query("web",a.join(" "))}};this.render=function(e,d,b,c,a){if(goosh.ajax.iscontext(e)){this.renderResult(e);if(d.results[0].unescapedUrl){setTimeout('window.location.href = "'+d.results[0].unescapedUrl+'"',0)}goosh.gui.showinput();goosh.gui.focusinput();goosh.gui.scroll()}}};goosh.modules.register("lucky","web");goosh.module.more=function(){this.name="more";this.aliases=new Array("more","m");this.help="get more results";this.call=function(a){if(goosh.config.moreobj&&goosh.config.moreobj.hasmore){goosh.config.moreobj.more()}}};goosh.modules.register("more");goosh.module.news=function(){this.name="news";this.aliases=new Array("news","n");this.mode=true;this.parameters="[keywords]";this.help="google news search";this.helptext="<span class='info'>examples:</span><br/><i>blog foo bar</i>  - searches for &quot;foo bar&quot; news<br/>"};goosh.modules.register("news","web");goosh.module.open=function(){this.name="open";this.aliases=new Array("open","o");this.parameters="&lt;url>";this.help="open url in new window";this.helptext="<span class='info'>examples:</span><br/><i>open 1 3</i>  - open first and third result from last search<br/>";this.call=function(b){for(i=0;i<b.length;i++){var a=b[i];if(a.indexOf("http://")==-1&&a.indexOf("https://")){a="http://"+a}window.open(a,"_blank","")}}};goosh.modules.register("open");goosh.module.read=function(){this.name="read";this.aliases=new Array("read","rss","r");this.mode=false;this.start=0;this.parameters="&lt;url>";this.help="read feed of url";this.helptext="<span class='info'>examples:</span><br/><i>read reddit.com</i>  - read reddit.com-feed<br/>";this.query=function(a,b){goosh.ajax.query("//ajax.googleapis.com/ajax/services/feed/load?v=1.0&hl="+goosh.config.lang+"&callback=goosh.modobj."+this.name+".render&num=100&scoring=h&q="+encodeURIComponent(b)+"&key="+goosh.config.apikey)};this.lookup=function(a,b){goosh.ajax.query("//ajax.googleapis.com/ajax/services/feed/lookup?v=1.0&hl="+goosh.config.lang+"&callback=goosh.modobj."+this.name+".lookupdone&q="+encodeURIComponent(b)+"&key="+goosh.config.apikey)};this.lookupdone=function(e,d,b,c,a){if(d){if(d.url){if(goosh.ajax.iscontext(e)){this.query(this.name,d.url)}}}else{goosh.gui.error("feed &quot;"+this.args+"&quot; not found.<br/> Try the &quot;feed&quot;-command to find feeds.")}};this.call=function(a){if(a.length>0){this.start=0;this.results=new Array();this.args=a.join(" ");this.lookup(this.name,a.join(" "))}};this.render=function(e,d,b,c,a){if(goosh.ajax.iscontext(e)){if(d){d.results=new Array();for(i=0;i<d.feed.entries.length;i++){if(d.feed.entries[i]){d.results[i]=d.feed.entries[i]}}for(i=0;i<d.results.length;i++){if(d.results[i]){var f=d.results[i];d.results[i].unescapedUrl=f.link;d.results[i].content=f.contentSnippet}}this.results=d.results;this.hasmore=true;this.renderResult(e,d,b,c,a);goosh.gui.showinput();goosh.gui.focusinput();goosh.gui.scroll()}else{goosh.gui.error("Error: feed &quot;"+this.args+"&quot; not found.<br/> Try the &quot;feed&quot;-command to find feeds.")}}};this.more=function(){if(this.args){this.start+=parseInt(goosh.config.numres);if(this.results.length<=this.start+parseInt(goosh.config.numres)){this.hasmore=false;moreobj=false}this.renderResult()}}};goosh.modules.register("read","web");goosh.module.settings=function(){this.name="settings";this.aliases=new Array("settings","set");this.help="edit settings";this.parameters="[name] [value]";this.helptext="<span class='info'>examples:</span><br/><i>set lang de</i>  - sets language to german<br/><i>set lang</i>  - displays value of lang-setting<br/><i>settings</i>  - displays all settings<br/><i>settings reset</i>  - reset all settings to default values<br/>";this.call=function(b){var a="";if(b[0]&&b[1]){if(goosh.set.list[b[0]]&&goosh.set.list[b[0]].set(b[1])){if(goosh.set.list[b[0]].get()==goosh.set.list[b[0]].def){goosh.lib.cookie.del(b[0])}else{goosh.lib.cookie.set(b[0],goosh.set.list[b[0]].get(),365)}b[1]=false}else{goosh.gui.error("Could not set "+b[0]+" to &quot;"+b[1]+"&quot;");return false}}if(b[0]&&!b[1]){if(b[0]=="reset"){for(key in goosh.set.list){goosh.set.list[key].set(goosh.set.list[key].def);goosh.lib.cookie.del(key)}a+="Settings where set to default values."}else{if(goosh.set.list[b[0]]){a+=b[0]+" is set to &quot;"+goosh.set.list[b[0]].get()+"&quot;.<br>"}else{goosh.gui.error("No setting with that name.")}}}else{a+="<table border='0' class='help'><tr>";a+="<tr><td class='less'>name</td><td class='less'>value</td><td class='less'>default</td><td class='less'>help</td></tr>";for(key in goosh.set.list){a+="<td";a+=" class='info'";a+=">"+key+"</td>";a+="<td>"+goosh.set.list[key].get()+"</td>";a+="<td class='less'>"+goosh.set.list[key].def+"</td>";a+="<td class='less'>"+goosh.set.list[key].txt+"</td>";a+="</tr><tr>"}a+="</tr></table>"}goosh.gui.outln(a)}};goosh.modules.register("settings");goosh.module.sponsors=function(){this.name="sponsors";this.aliases=new Array("sponsors");this.help="A list of people who have supported goosh";this.parameters="";this.call=function(a){goosh.gui.outln("A list of people who have supported goosh:");goosh.gui.outln("");goosh.gui.outln("1. Levonn");goosh.gui.outln('2. <a href="https://www.patreon.com/goosh?ty=h" target="_blank">Your name here? Support goosh (and me) on patreon!</a>');goosh.gui.outln("")}};goosh.modules.register("sponsors");goosh.module.translatepage=function(){this.name="translatepage";this.aliases=new Array("translatepage","transpage","tp");this.parameters="[lang1] &lt;lang2> &lt;url>";this.help="google page translation*";this.helptext="<span class='info'>Translate full webpages with Google, using google's 2 character language codes</span><br/>";this.convertToURL=function(b,a,e,d){var c="";c=e;c="&u="+c;c=a+c;c="&tl="+c;if(d){c="sl=auto"+c}else{c=b+c;c="sl="+c}c="http://translate.google.com/translate?"+c;return c};this.call=function(b){var d="";var c="";var f="";var e=false;if(b.length==3){d=b[0];c=b[1];f=b[2]}else{if(b.length==2){c=b[0];f=b[1];e=true}else{goosh.gui.error("Could not translate.");return false}}var a=this.convertToURL(d,c,f,e);window.open(a,"_top","",false)}};goosh.modules.register("translatepage");goosh.module.wiki=function(){this.name="wiki";this.aliases=new Array("wikipedia","wiki");this.mode=true;this.help="wikipedia search";this.helptext="<span class='info'>examples:</span><br/><i>wiki foo bar</i>  - searches &quot;foo bar&quot; in wikipedia<br/>"};goosh.modules.register("wiki","web");goosh.command=function(){var g=goosh.gui.inputfield.value;var f=g.split(" ");var c=new Array();for(i=0;i<f.length;i++){if(f[i]!=""){if(f[0]!="set"&&f[0]!="settings"){var b=1;while(goosh.config.urls[b]){if(f[i]==b){f[i]=goosh.config.urls[b];if(i==0){c.push("open")}}b++}}c.push(f[i])}}var e;for(key in goosh.modules.list){if(goosh.lib.in_array(goosh.modules.list[key].aliases,c[0])){e=goosh.modules.list[key];c[0]=e.name;break}}if(c.length==0&&goosh.config.moreobj&&goosh.config.moreobj.hasmore){e=goosh.modules.list.more;c[0]="more"}var a=c.join(" ");if(encodeURIComponent(a)!=goosh.lib.get("q")&&a!="more"&&a!="logout"){window.location.hash="#"+encodeURIComponent(a)}goosh.gui.out("<div class='input'><span class='less'>"+goosh.gui.prompt+"</span>"+a.replace(/</g,"&lt;")+"</div>");if(a!=""){goosh.keyboard.hist[goosh.keyboard.hist.length]=a;goosh.keyboard.histpos=goosh.keyboard.hist.length}var d="";if(!e){e=goosh.modules.list[goosh.config.mode]}else{for(i=0;i<c.length-1;i++){c[i]=c[i+1]}c.pop()}if(e.more&&c.length>0){this.config.moreobj=e}if(c.length==0&&e.mode){goosh.config.mode=e.name;goosh.gui.updateprompt()}else{e.call(c)}goosh.gui.scroll();goosh.gui.inputfield.value="";goosh.gui.focusinput();return false};goosh.onload=function(f,h){var b=false;try{if(parent.goosh!=goosh){var a=document.getElementById("body");a.innerHTML="";goosh=parent.goosh;b=true}}catch(f){}goosh.gui.init();if(!h&&(b||document.cookie.indexOf("loggedin")!=-1)){goosh.ajax.query("http://goosh.appspot.com/status?callback=goosh.onload");return}else{if(goosh.ajax.iscontext(f)){goosh.config.user=h;var g=goosh.gui.el("gooshlogin");var c=goosh.gui.el("gooshloginparent");if(g&&c){goosh.gui.outputel.removeChild(goosh.gui.outputel.lastChild)}}}if(h&&h!="guest"){goosh.lib.cookie.set("loggedin","1",365)}goosh.set.init()};goosh.getquery=function(){var a="";if(goosh.lib.get("q")){a=goosh.lib.get("q")}if(window.location.hash){a=decodeURIComponent(window.location.hash.substr(1))}a+=" ";if(a!=" "&&a.substr(0,6)!="login "&&a.substr(0,4)!="set "&&a.substr(0,9)!="settings "){goosh.gui.inputfield.value=a.substr(0,a.length)}else{goosh.gui.inputfield.value=""}goosh.gui.updateprompt();goosh.gui.showinput();goosh.gui.focusinput();if(goosh.gui.inputfield.value!=""){goosh.command()}};if(typeof window.addEventListener!=="undefined"){window.addEventListener("load",goosh.onload,false)}else{if(typeof window.attachEvent!=="undefined"){window.attachEvent("onload",goosh.onload)}}google.load("search","1",{language:goosh.config.lang,nocss:"true"});google.setOnLoadCallback(function(){loaded=true},true);